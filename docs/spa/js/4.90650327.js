(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"2aa8":function(t,e,i){"use strict";i("c3c5")},"4a85":function(t,e,i){},"8b24":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{ref:"movieList",staticClass:"movie-list"},t._l(t.movies,(function(i){return e("div",{key:i.id,staticClass:"movie-list--card"},[e("MovieCard",{attrs:{poster:i.poster_path,title:i.title,date:i.release_date,genres:t.getMovieGenre(i.genre_ids),votes:i.vote_average,id:i.id}})],1)})),0)},a=[],r=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"movie-card"}},[e("q-card",{staticClass:"movie-card"},[e("img",{staticClass:"movie-card--img",attrs:{src:`https://image.tmdb.org/t/p/original${t.poster}`}}),e("div",{staticClass:"row col-auto movie-card--favorite"},[e("q-btn",{attrs:{color:t.isFavorite?"red-7":"grey-7",ripple:!1,icon:"favorite",round:"",flat:""},on:{click:t.toggleFavorite}})],1),e("div",{staticClass:"movie-card--date"},[e("div",{staticClass:"movie-card--date-text"},[t._v(t._s(t.formattedDate))])]),e("q-card-section",[e("div",{staticClass:"movie-card--info"},[e("div",{staticClass:"name"},[t._v(t._s(t.title))]),e("div",{staticClass:"gender"},[e("q-icon",{staticClass:"icon",attrs:{size:"sm",name:"r_star"}}),e("span",{staticClass:"icon--text"},[t._v(t._s(t.votes)+" ")]),e("div",{staticClass:"gender"},[t._v(t._s(t.genres))])],1),e("div",{staticClass:"price"},[t._v("R$ 9,99")])])]),e("q-separator"),e("q-card-actions",[e("q-btn",{staticClass:"movie-card--button full-width",attrs:{"no-caps":""},on:{click:function(e){return t.addToCart()}}},[t._v("Adicionar")])],1)],1)],1)},o=[],n=(i("14d9"),i("e8ec")),c=i("b166"),l=i("e018"),d={name:"MovieCard",props:{title:{type:String,default:""},date:{type:String,default:""},poster:{type:String,default:""},genres:{type:String,default:""},votes:{type:Number,default:null},id:{type:Number,default:null}},data(){return{isFavorite:!1}},computed:{formattedDate(){const t=new Date(this.date.replace(/-/g,"/"));return Object(c["a"])(t,"d 'de' MMMM, yyyy",{locale:l["a"]})}},created(){this.checkFavoriteStatus(),Object(n["d"])(this.checkFavoriteStatus)},methods:{createMovieObject(t,e,i,s){return{id:t,title:e,poster:i,genres:s,quantity:1}},addToCart(){let t=JSON.parse(localStorage.getItem("cart"))||[];const e=t.find((t=>t.id===this.id));e?e.quantity++:t.push(this.createMovieObject(this.id,this.title,this.poster,this.genres)),localStorage.setItem("cart",JSON.stringify(t))},toggleFavorite(){if(this.isFavorite){let t=JSON.parse(localStorage.getItem("favorites"))||[];t=t.filter((t=>t.id!==this.id)),localStorage.setItem("favorites",JSON.stringify(t))}else{let t=JSON.parse(localStorage.getItem("favorites"))||[];t.push({id:this.id,title:this.title,poster:this.poster,genres:this.genres}),localStorage.setItem("favorites",JSON.stringify(t))}this.isFavorite=!this.isFavorite},checkFavoriteStatus(){let t=JSON.parse(localStorage.getItem("favorites"))||[];this.isFavorite=t.some((t=>t.id===this.id))}}},v=d,u=(i("abd9"),i("2877")),h=Object(u["a"])(v,r,o,!1,null,"5309771b",null),g=h.exports,f={name:"PageIndex",components:{MovieCard:g},data(){return{movies:[],genres:[],currentPage:1,loading:!1,offset:200}},created(){this.fetchMovies(),this.fetchGenres(),window.addEventListener("scroll",this.handleScroll)},destroyed(){window.removeEventListener("scroll",this.handleScroll)},methods:{fetchMovies(){this.$movie.getPopularMovies({page:this.currentPage}).then((t=>{this.movies=this.movies.concat(t.data.results),this.loading=!1})).catch((()=>{this.$notifyError("Erro ao buscar filmes!")}))},fetchGenres(){this.$movie.getMovieGenres().then((t=>{this.genres=t.data.genres})).catch((()=>{this.$notifyError("Erro ao buscar generos!")}))},getMovieGenre(t){const e=this.genres.filter((e=>t.includes(e.id))).slice(0,4);return e.map((t=>t.name)).join(", ")},handleScroll(){const t=this.$refs.movieList,e=window.pageYOffset+window.innerHeight,i=t.offsetHeight;e>=i-window.innerHeight-this.offset&&!this.loading&&(this.loading=!0,this.currentPage++,this.fetchMovies())}}},m=f,p=(i("2aa8"),Object(u["a"])(m,s,a,!1,null,"1a78884a",null));e["default"]=p.exports},abd9:function(t,e,i){"use strict";i("4a85")},c3c5:function(t,e,i){},e8ec:function(t,e,i){"use strict";function s(t){let e=a();setInterval((()=>{const i=a();i!==e&&(e=i,t(e))}),1e3)}function a(){const t=JSON.parse(localStorage.getItem("favorites"))||[];return t.length}function r(t){let e=o();setInterval((()=>{const i=o();i!==e&&(e=i,t(e))}),1e3)}function o(){const t=JSON.parse(localStorage.getItem("cart"))||[];return t.length}i.d(e,"d",(function(){return s})),i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return o}))}}]);